# Workflow Overview

## Core Research Pipeline

The application follows a strict 4-stage pipelines to transform a user topic into a finished report.

```mermaid
sequenceDiagram
  participant U as User
  participant F as Frontend
  participant B as Backend
  participant G as Gemini
  participant S as Search

  U->>F: Enters Topic
  F->>B: POST /research
  activate B
  
  Note over B: Initialize AgentState
  
  %% Step 1: Strategist
  B->>G: Prompt: "Create research plan"
  G-->>B: Research Strategy
  B-->>F: SSE: Step "Strategist"
  
  %% Step 2: Researcher
  B->>G: Prompt: "Extract queries"
  G-->>B: Search Queries
  loop For each Query
      B->>S: Search Web
      S-->>B: Results
  end
  B-->>F: SSE: Step "Researcher" (with sources)
  
  %% Step 3: Analyst
  B->>G: Prompt: "Analyze findings"
  G-->>B: Insights & Trends
  B-->>F: SSE: Step "Analyst"
  
  %% Step 4: Synthesizer
  B->>G: Prompt: "Draft Report (JSON)"
  G-->>B: Final JSON/Markdown
  
  B-->>F: SSE: Complete
  deactivate B
  F->>U: Render Report
```

## Detailed Steps

### 1. Strategist
**Goal**: Deconstruct the user's request into actionable research questions.
- **Input**: Raw user topic.
- **Output**: A structured plan containing context, questions, and recommended sources.

### 2. Researcher
**Goal**: Gather grounding data from the real world.
- **Input**: Research plan.
- **Action**: Generates search queries, executes them against Brave/Tavily APIs, and aggregates results.
- **Output**: Raw textual data and citation metadata.

### 3. Analyst
**Goal**: Extract meaning from raw data.
- **Input**: Raw search results.
- **Action**: Identifies trends, computes metrics (if available), and structures the "messy" web data.
- **Output**: Synthesized insights and key metrics.

### 4. Synthesizer
**Goal**: Produce the final artifact.
- **Input**: Analyst insights.
- **Action**: Formats the content into a professional report structure, injecting JSON metadata for UI rendering.
- **Output**: Final Markdown/JSON report.

## Data Flow

```mermaid
flowchart LR
    User[User Input] --> Plan[Research Plan]
    Plan --> Queries[Search Queries]
    Queries --> Web[Web Results]
    Web --> Insights[Structured Insights]
    Insights --> Report[Final Report]
```
